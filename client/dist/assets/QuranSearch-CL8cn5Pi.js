import{j as e,B as a,y as s,N as r,O as t,U as n,S as i,r as l,a8 as o,M as h,T as d,I as x,G as u,H as c,d as m,c as p,J as b,at as j,Z as g,a7 as y,ar as f,ac as v,ad as N,ae as w,A as S,F as k,s as C}from"./mui-Do46CX0U.js";import{b as A,u as I}from"./redux-BPU-OxaI.js";import{y as $,z,A as P}from"./index-DIZzTGyO.js";import{a as R}from"./utils-DVma4InU.js";import"./vendor-DEQ385Nk.js";const H=()=>e.jsxs(a,{sx:{maxHeight:"50vh",overflow:"auto"},children:[e.jsx(s,{}),e.jsx(r,{sx:{p:0},children:[...Array(5)].map((s,r)=>e.jsx(t,{sx:{borderBottom:r<4?"1px solid rgba(0,0,0,0.06)":"none",py:2},children:e.jsx(n,{primary:e.jsxs(a,{children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[e.jsx(i,{variant:"text",width:"75%",height:20,sx:{flex:1}}),e.jsx(i,{variant:"circular",width:24,height:24,sx:{ml:1}})]}),e.jsx(i,{variant:"text",width:"100%",height:16,sx:{mb:.5}}),e.jsx(i,{variant:"text",width:"95%",height:16,sx:{mb:.5}}),e.jsx(i,{variant:"text",width:"80%",height:16})]})})},r))})]}),T=({onSelectAyah:i,onClose:T})=>{const[M,E]=l.useState(""),[W,B]=l.useState([]),[F,K]=l.useState(!1),[Q,O]=l.useState(null),[U,Y]=l.useState(!0),[_,q]=l.useState(0),[G,J]=l.useState(!1),L=A(),Z=I(e=>e.settings.search.translationEdition),D=I(e=>e.favorites.items),V=Z,X=async()=>{if(M.trim()){K(!0),O(null),J(!0);try{const e=await R.get(`https://api.alquran.cloud/v1/search/${encodeURIComponent(M)}/all/${V}`);if(e.data&&e.data.data&&e.data.data.matches){const a=e.data.data.matches.map(e=>({surahNumber:e.surah.number,ayahNumber:e.numberInSurah,verseKey:`${e.surah.number}:${e.numberInSurah}`,arabicText:e.text,translation:e.text,highlighted:ee(e.text,M),surahName:e.surah.englishName,surahArabicName:e.surah.name}));B(a),q(e.data.data.count||a.length)}else B([]),q(0)}catch(e){e.response&&404===e.response.status?(B([]),q(0),O(null)):(O("Failed to search. Please try again."),B([]),q(0))}finally{K(!1)}}},ee=(e,a)=>{if(!e||!a)return e;const s=new RegExp(`(${a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return e.replace(s,'<mark style="background-color: #ffeb3b; padding: 1px 2px; border-radius: 2px;">$1</mark>')},ae=(e,a)=>{const s=`ayah-${e}-${a}`;return D.some(e=>e.id===s)};return e.jsx(o,{open:!0,onClose:T,closeAfterTransition:!0,children:e.jsxs(a,{className:"modal-enter",sx:{position:"fixed",top:20,right:20,width:{xs:"90vw",sm:"400px",md:"450px"},maxHeight:"80vh",overflowY:"auto",bgcolor:"rgba(255, 255, 255, 0.98)",backdropFilter:"blur(20px)",borderRadius:3,boxShadow:"0 25px 50px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.2)"},children:[e.jsxs(a,{sx:{p:2,backgroundColor:"primary.main",color:"white",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(a,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(h,{}),e.jsx(d,{variant:"h6",sx:{fontWeight:600},children:"Search Quran"})]}),e.jsxs(a,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(x,{size:"small",onClick:()=>Y(!U),sx:{color:"white"},children:U?e.jsx(u,{}):e.jsx(c,{})}),e.jsx(x,{size:"small",onClick:T,sx:{color:"white"},children:e.jsx(m,{})})]})]}),e.jsxs(p,{in:U,children:[e.jsxs(a,{sx:{p:2},children:[e.jsx(b,{fullWidth:!0,placeholder:"Search for keywords in the Quran...",value:M,onChange:e=>E(e.target.value),onKeyPress:e=>{"Enter"===e.key&&X()},InputProps:{endAdornment:e.jsx(j,{position:"end",children:e.jsx(x,{onClick:X,disabled:F,children:F?e.jsx(g,{size:20}):e.jsx(y,{})})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2},mb:2}}),e.jsxs(f,{fullWidth:!0,size:"small",sx:{mb:2},children:[e.jsx(v,{children:"Translation"}),e.jsx(N,{value:V,label:"Translation",onChange:e=>L($(e.target.value)),sx:{borderRadius:2},MenuProps:{PaperProps:{sx:{zIndex:3e3}}},children:[{identifier:"en.asad",name:"Muhammad Asad"},{identifier:"en.yusufali",name:"Yusuf Ali"},{identifier:"en.pickthall",name:"Pickthall"},{identifier:"en.sahih",name:"Saheeh International"}].map(a=>e.jsx(w,{value:a.identifier,children:a.name},a.identifier))})]}),M&&!F&&G&&e.jsx(a,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsx(d,{variant:"caption",color:"text.secondary",children:_>0?`${_} result${1!==_?"s":""} found`:"No results found"})})]}),Q&&e.jsx(a,{sx:{px:2,pb:2},children:e.jsx(S,{severity:"error",sx:{borderRadius:2},children:Q})}),F&&G?e.jsx(H,{}):W.length>0?e.jsxs(a,{sx:{maxHeight:"50vh",overflow:"auto"},children:[e.jsx(s,{}),e.jsx(r,{sx:{p:0},children:W.map((s,r)=>e.jsx(t,{button:!0,className:"stagger-item smooth-hover",onClick:()=>(e=>{i(e.surahNumber,e.ayahNumber),T()})(s),sx:{borderBottom:r<W.length-1?"1px solid rgba(0,0,0,0.06)":"none","&:hover":{backgroundColor:"rgba(25, 118, 210, 0.04)"}},children:e.jsx(n,{primary:e.jsxs(a,{children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:.5},children:[e.jsxs(d,{variant:"subtitle2",sx:{fontWeight:600,color:"primary.main",flex:1},children:["Surah ",s.surahNumber,": ",s.surahName," (",s.surahArabicName,") - Ayah"," ",s.ayahNumber]}),e.jsx(x,{size:"small",onClick:e=>((e,a)=>{a.stopPropagation();const s=`ayah-${e.surahNumber}-${e.ayahNumber}`;if(ae(e.surahNumber,e.ayahNumber))L(z(s));else{const a={id:s,type:"ayah",surahNumber:e.surahNumber,ayahNumber:e.ayahNumber,text:e.translation,audio:"",note:"",surahName:e.surahName,surahArabicName:e.surahArabicName};L(P(a))}})(s,e),sx:{ml:1,color:ae(s.surahNumber,s.ayahNumber)?"red":"text.secondary","&:hover":{color:"red"}},children:ae(s.surahNumber,s.ayahNumber)?e.jsx(k,{fontSize:"small"}):e.jsx(C,{fontSize:"small"})})]}),e.jsx(d,{variant:"body2",sx:{lineHeight:1.4,"& mark":{backgroundColor:"#ffeb3b",padding:"1px 2px",borderRadius:"2px"}},dangerouslySetInnerHTML:{__html:s.highlighted}})]})})},s.verseKey))})]}):null,!F&&M&&0===W.length&&!Q&&G&&e.jsx(a,{sx:{p:3,textAlign:"center"},children:e.jsxs(d,{variant:"body2",color:"text.secondary",children:['No results found for "',M,'"']})}),!M&&e.jsx(a,{sx:{p:3,textAlign:"center"},children:e.jsx(d,{variant:"body2",color:"text.secondary",children:"Enter keywords to search through the Quran"})})]})]})})};export{T as default};
