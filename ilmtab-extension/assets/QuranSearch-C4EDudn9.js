import{j as e,B as a,y as s,N as r,O as t,U as n,S as i,r as l,a8 as o,M as h,T as d,I as x,G as u,H as c,d as m,c as p,J as b,at as g,Z as j,a7 as f,ar as y,ac as v,ad as N,ae as w,A as S,F as k,s as C}from"./mui-BS7ftOUA.js";import{u as I}from"./index-BZ03FPYE.js";import{a as A}from"./utils-DVma4InU.js";import"./vendor-eVk5PToZ.js";const $=()=>e.jsxs(a,{sx:{maxHeight:"50vh",overflow:"auto"},children:[e.jsx(s,{}),e.jsx(r,{sx:{p:0},children:[...Array(5)].map((s,r)=>e.jsx(t,{sx:{borderBottom:r<4?"1px solid rgba(0,0,0,0.06)":"none",py:2},children:e.jsx(n,{primary:e.jsxs(a,{children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[e.jsx(i,{variant:"text",width:"75%",height:20,sx:{flex:1}}),e.jsx(i,{variant:"circular",width:24,height:24,sx:{ml:1}})]}),e.jsx(i,{variant:"text",width:"100%",height:16,sx:{mb:.5}}),e.jsx(i,{variant:"text",width:"95%",height:16,sx:{mb:.5}}),e.jsx(i,{variant:"text",width:"80%",height:16})]})})},r))})]}),z=({onSelectAyah:i,onClose:z})=>{var P;const[R,H]=l.useState(""),[T,E]=l.useState([]),[F,M]=l.useState(!1),[W,B]=l.useState(null),[K,Q]=l.useState(!0),[O,U]=l.useState(0),[Y,_]=l.useState(!1),{settings:q,favorites:G}=I(),J=((null==(P=null==q?void 0:q.settings)?void 0:P.search)||{}).translationEdition||"en.asad",L=async()=>{if(R.trim()){M(!0),B(null),_(!0);try{const e=await A.get(`https://api.alquran.cloud/v1/search/${encodeURIComponent(R)}/all/${J}`);if(e.data&&e.data.data&&e.data.data.matches){const a=e.data.data.matches.map(e=>({surahNumber:e.surah.number,ayahNumber:e.numberInSurah,verseKey:`${e.surah.number}:${e.numberInSurah}`,arabicText:e.text,translation:e.text,highlighted:Z(e.text,R),surahName:e.surah.englishName,surahArabicName:e.surah.name}));E(a),U(e.data.data.count||a.length)}else E([]),U(0)}catch(e){e.response&&404===e.response.status?(E([]),U(0),B(null)):(B("Failed to search. Please try again."),E([]),U(0))}finally{M(!1)}}},Z=(e,a)=>{if(!e||!a)return e;const s=new RegExp(`(${a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return e.replace(s,'<mark style="background-color: #ffeb3b; padding: 1px 2px; border-radius: 2px;">$1</mark>')},D=(e,a)=>{var s;const r=`ayah-${e}-${a}`;return(null==(s=null==G?void 0:G.favorites)?void 0:s.some(e=>e.id===r))||!1};return e.jsx(o,{open:!0,onClose:z,closeAfterTransition:!0,children:e.jsxs(a,{className:"modal-enter",sx:{position:"fixed",top:20,right:20,width:{xs:"90vw",sm:"400px",md:"450px"},maxHeight:"80vh",overflowY:"auto",bgcolor:"rgba(255, 255, 255, 0.98)",backdropFilter:"blur(20px)",borderRadius:3,boxShadow:"0 25px 50px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.2)"},children:[e.jsxs(a,{sx:{p:2,backgroundColor:"primary.main",color:"white",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(a,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(h,{}),e.jsx(d,{variant:"h6",sx:{fontWeight:600},children:"Search Quran"})]}),e.jsxs(a,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(x,{size:"small",onClick:()=>Q(!K),sx:{color:"white"},children:K?e.jsx(u,{}):e.jsx(c,{})}),e.jsx(x,{size:"small",onClick:z,sx:{color:"white"},children:e.jsx(m,{})})]})]}),e.jsxs(p,{in:K,children:[e.jsxs(a,{sx:{p:2},children:[e.jsx(b,{fullWidth:!0,placeholder:"Search for keywords in the Quran...",value:R,onChange:e=>{const a=e.target.value;H(a),""===a.trim()&&(_(!1),E([]),U(0),B(null))},onKeyPress:e=>{"Enter"===e.key&&L()},InputProps:{endAdornment:e.jsx(g,{position:"end",children:e.jsx(x,{onClick:L,disabled:F,children:F?e.jsx(j,{size:20}):e.jsx(f,{})})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2},mb:2}}),e.jsxs(y,{fullWidth:!0,size:"small",sx:{mb:2},children:[e.jsx(v,{children:"Translation"}),e.jsx(N,{value:J,label:"Translation",onChange:e=>(e=>{const a=(null==q?void 0:q.settings)||{};null==q||q.updateSettings({...a,search:{...a.search,translationEdition:e}})})(e.target.value),sx:{borderRadius:2},MenuProps:{PaperProps:{sx:{zIndex:3e3}}},children:[{identifier:"en.asad",name:"Muhammad Asad"},{identifier:"en.yusufali",name:"Yusuf Ali"},{identifier:"en.pickthall",name:"Pickthall"},{identifier:"en.sahih",name:"Saheeh International"}].map(a=>e.jsx(w,{value:a.identifier,children:a.name},a.identifier))})]}),!F&&Y&&T.length>0&&e.jsx(a,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsxs(d,{variant:"caption",color:"text.secondary",children:[O," result",1!==O?"s":""," found"]})})]}),W&&e.jsx(a,{sx:{px:2,pb:2},children:e.jsx(S,{severity:"error",sx:{borderRadius:2},children:W})}),F&&Y?e.jsx($,{}):T.length>0?e.jsxs(a,{sx:{maxHeight:"50vh",overflow:"auto"},children:[e.jsx(s,{}),e.jsx(r,{sx:{p:0},children:T.map((s,r)=>e.jsx(t,{button:!0,className:"stagger-item smooth-hover",onClick:()=>(e=>{i(e.surahNumber,e.ayahNumber),z()})(s),sx:{borderBottom:r<T.length-1?"1px solid rgba(0,0,0,0.06)":"none","&:hover":{backgroundColor:"rgba(25, 118, 210, 0.04)"}},children:e.jsx(n,{primary:e.jsxs(a,{children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:.5},children:[e.jsxs(d,{variant:"subtitle2",sx:{fontWeight:600,color:"primary.main",flex:1},children:["Surah ",s.surahNumber,": ",s.surahName," (",s.surahArabicName,") - Ayah"," ",s.ayahNumber]}),e.jsx(x,{size:"small",onClick:e=>((e,a)=>{a.stopPropagation();const s=`ayah-${e.surahNumber}-${e.ayahNumber}`;if(D(e.surahNumber,e.ayahNumber))null==G||G.removeFavorite(s);else{const a={id:s,type:"ayah",surahNumber:e.surahNumber,ayahNumber:e.ayahNumber,text:e.translation,audio:"",note:"",surahName:e.surahName,surahArabicName:e.surahArabicName};null==G||G.addFavorite(a)}})(s,e),sx:{ml:1,"&:hover":{color:"error.main"}},children:D(s.surahNumber,s.ayahNumber)?e.jsx(k,{fontSize:"small",color:"error"}):e.jsx(C,{fontSize:"small",color:"action"})})]}),e.jsx(d,{variant:"body2",sx:{lineHeight:1.4,"& mark":{backgroundColor:"#ffeb3b",padding:"1px 2px",borderRadius:"2px"}},dangerouslySetInnerHTML:{__html:s.highlighted}})]})})},s.verseKey))})]}):null,!F&&R&&0===T.length&&!W&&Y&&e.jsx(a,{sx:{p:3,textAlign:"center"},children:e.jsxs(d,{variant:"body2",color:"text.secondary",children:['No results found for "',R,'"']})}),!R&&e.jsx(a,{sx:{p:3,textAlign:"center"},children:e.jsx(d,{variant:"body2",color:"text.secondary",children:"Enter keywords to search through the Quran"})})]})]})})};export{z as default};
